{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<div class="form-container" style="max-width: 800px; margin: 30px auto; padding: 25px;">
    <h2 style="text-align: center; color: var(--azul); margin-bottom: 30px;">
        <i class="fas fa-edit"></i> Editar Consulta
    </h2>

    <a href="{% url 'veterinarios:listar_consultas' %}" class="back-link" style="display: inline-block; margin-bottom: 20px;">
        ← Voltar para Consultas
    </a>

    <!-- Informações da consulta (somente leitura) -->
    <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
        <h3 style="color: var(--azul); margin-bottom: 15px;">Informações da Consulta</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div>
                <p style="margin: 5px 0;"><strong>Tutor:</strong> {{ consulta.tutor.usuario.get_full_name|default:consulta.tutor.usuario.first_name }}</p>
                <p style="margin: 5px 0;"><strong>Animal:</strong> {{ consulta.animal.nome }} ({{ consulta.animal.especie }})</p>
            </div>
            <div>
                <p style="margin: 5px 0;"><strong>Clínica:</strong> {{ consulta.clinic.nome }}</p>
                {% if consulta.service %}
                    <p style="margin: 5px 0;"><strong>Serviço:</strong> {{ consulta.service.name }}</p>
                {% endif %}
            </div>
        </div>
    </div>

    <form method="POST" id="editar-consulta-form">
        {% csrf_token %}

        <div class="form-group">
            <label for="{{ form.status.id_for_label }}">Status <span style="color: red;">*</span></label>
            {% render_field form.status class="form-control" %}
            {% if form.status.errors %}
                <div class="error-msg">
                    {% for error in form.status.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
            <small class="form-text text-muted">O tutor será notificado automaticamente se o status for alterado</small>
        </div>

        <div class="form-group">
            <label for="{{ form.date.id_for_label }}">Data e Hora <span style="color: red;">*</span></label>
            {% render_field form.date class="form-control" %}
            {% if form.date.errors %}
                <div class="error-msg">
                    {% for error in form.date.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="{{ form.notes.id_for_label }}">Observações</label>
            {% render_field form.notes class="form-control" %}
            {% if form.notes.errors %}
                <div class="error-msg">
                    {% for error in form.notes.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button type="submit" class="btn-submit" style="flex: 1;">
                <i class="fas fa-save"></i> Salvar Alterações
            </button>
            <a href="{% url 'veterinarios:listar_consultas' %}" class="btn-primary" style="flex: 1; text-align: center; text-decoration: none; padding: 12px; border-radius: 8px;">
                <i class="fas fa-times"></i> Cancelar
            </a>
        </div>
    </form>
</div>

{% endblock %}



