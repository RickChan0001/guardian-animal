{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="form-card">
    <h2>Editar Animal - {{ animal.nome }}</h2>

    <div class="photo-upload-container">

        {% if animal.foto %}
            <img id="preview" src="{{ animal.foto.url }}" alt="preview" class="photo-preview">
        {% else %}
            <img id="preview" src="{% static 'images/default-pet.jpg' %}" alt="preview" class="photo-preview">
        {% endif %}

        <label class="upload-btn">
            Trocar Foto
            {{ form.foto }}
        </label>
    </div>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-row">
            <div class="fields-col">

                <label>Nome</label>
                {{ form.nome }}

                <label>Espécie</label>
                {{ form.especie }}

                <label>Raça</label>
                {{ form.raca }}

                <label>Idade</label>
                {{ form.idade }}

                <label>Altura</label>
                {{ form.altura }}

                <label>Peso</label>
                {{ form.peso }}

                <label>Observações</label>
                {{ form.observacoes }}

                <button class="btn-primary" type="submit">Salvar Alterações</button>

                <a href="{% url 'tutores:painel_tutor' %}"
                   class="btn-primary"
                   style="margin-top: 15px; background-color: #6c757d;">
                    ← Voltar ao Painel
                </a>
            </div>
        </div>
    </form>
</div>

<script>
    const inputFoto = document.getElementById('{{ form.foto.id_for_label }}');
    const preview = document.getElementById('preview');

    if (inputFoto) {
        inputFoto.addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(ev) {
                preview.src = ev.target.result;
            };
            reader.readAsDataURL(file);
        });
    }
</script>

{% endblock %}
